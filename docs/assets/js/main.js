"use strict";const collapsibleTriggers=document.querySelectorAll(".js-collapsible__tigger");function updateCollapsible(e){const t=e.currentTarget.parentElement;if(t.classList.contains("content-collapsible"))t.classList.remove("content-collapsible");else{for(const e of collapsibleTriggers)e.parentElement.classList.remove("content-collapsible");t.classList.add("content-collapsible")}}for(const e of collapsibleTriggers)e.addEventListener("click",updateCollapsible);const palette1=document.getElementById("color-option1"),palette2=document.getElementById("color-option2"),palette3=document.getElementById("color-option3"),palette4=document.getElementById("color-option4"),card=document.querySelector(".js-card");function changeColorPalette(){const e=document.querySelector("input[type=radio]:checked").getAttribute("palette");card.classList.remove("js-card-palette1"),card.classList.remove("js-card-palette2"),card.classList.remove("js-card-palette3"),card.classList.remove("js-card-palette4"),card.classList.add(`js-card-${e}`),setToLocalStorage()}palette1.addEventListener("click",changeColorPalette),palette2.addEventListener("click",changeColorPalette),palette3.addEventListener("click",changeColorPalette),palette4.addEventListener("click",changeColorPalette);const nameEle=document.querySelector(".js-name"),cardNameEle=document.querySelector(".js-cardTitle"),jobEle=document.querySelector(".js-job"),cardJobEle=document.querySelector(".js-cardJob"),emailEle=document.querySelector(".js-email");let cardEmailEle=document.querySelector(".js-cardEmail");const phoneEle=document.querySelector(".js-phone");let cardPhoneEle=document.querySelector(".js-cardPhone");const linkedinEle=document.querySelector(".js-linkedin");let cardLinkedinEle=document.querySelector(".js-cardLinkedin");const githubEle=document.querySelector(".js-github");let cardGithubEle=document.querySelector(".js-cardGithub");const liElePhone=document.querySelector(".itemPhone"),liEleMail=document.querySelector(".itemEmail"),liEleLinkedin=document.querySelector(".itemLinkedin"),liEleGithub=document.querySelector(".itemGithub"),empty="",cardImage=document.querySelector(".card__image"),imgPreview=document.querySelector(".js__profile-preview"),submitEl=document.querySelector(".js-button"),shareEle=document.querySelector(".js-shareResult"),cardFieldsDefaultValues={name:"Nombre Apellido",job:"Front-end developer",phone:"tel:",email:"mailto:",linkedin:"",github:""};function changeCard(){let e=nameEle.value;cardNameEle.innerHTML=e!==empty?e:cardFieldsDefaultValues.name;let t=jobEle.value;cardJobEle.innerHTML=t!==empty?t:cardFieldsDefaultValues.job;let l=phoneEle.value;l!==empty?(liElePhone.classList.remove("opacity"),cardPhoneEle.href=`tel:${l}`):liElePhone.classList.add("opacity");let o=emailEle.value;o!==empty?(liEleMail.classList.remove("opacity"),cardEmailEle.href=`mailto:${o}`):liEleMail.classList.add("opacity");let a=linkedinEle.value;a!==empty?(liEleLinkedin.classList.remove("opacity"),cardLinkedinEle.href=a):liEleLinkedin.classList.add("opacity");let r=githubEle.value;r!==empty?(liEleGithub.classList.remove("opacity"),cardGithubEle.href=r):liEleGithub.classList.add("opacity"),setToLocalStorage()}nameEle.addEventListener("keyup",changeCard),jobEle.addEventListener("keyup",changeCard),emailEle.addEventListener("keyup",changeCard),phoneEle.addEventListener("keyup",changeCard),linkedinEle.addEventListener("keyup",changeCard),githubEle.addEventListener("keyup",changeCard);const containerForm=document.querySelector(".js-containerForm"),validation=function(e){e.preventDefault(),activateShareButton()},activateShareButton=function(){!0===containerForm.checkValidity()?submitEl.classList.add("share__button--active"):submitEl.classList.remove("share__button--active")};containerForm.addEventListener("change",validation);const fr=new FileReader,uploadBtn=document.querySelector(".js__profile-trigger"),fileField=document.querySelector(".js__profile-upload-btn"),profileImage=document.querySelector(".js__profile-image"),profilePreviewImg=document.querySelector(".js__profile-preview-img");function getImage(e){const t=e.currentTarget.files[0];fr.addEventListener("load",setImage),fr.readAsDataURL(t)}let picture="";function setImage(){picture=fr.result,previewImage(),setToLocalStorage()}function previewImage(){""!==picture&&(profileImage.style.backgroundImage=`url(${picture})`,profilePreviewImg.src=picture)}function fakeFileClick(e){e.preventDefault(),fileField.click()}uploadBtn.addEventListener("click",fakeFileClick),fileField.addEventListener("change",getImage);const setToLocalStorage=()=>{const e=document.querySelector("input[type=radio]:checked"),t={name:nameEle.value,job:jobEle.value,phone:phoneEle.value,email:emailEle.value,linkedin:linkedinEle.value,github:githubEle.value,colour:e.value,photo:picture};localStorage.setItem("userData",JSON.stringify(t))},getFromLocalStorage=()=>{const e=JSON.parse(localStorage.getItem("userData"));if(null!==e){nameEle.value=e.name,jobEle.value=e.job,phoneEle.value=e.phone,emailEle.value=e.email,linkedinEle.value=e.linkedin,githubEle.value=e.github,picture=e.photo;const t=e.colour;document.querySelector(`#color-option${t}`).checked=!0,activateShareButton(),changeCard(),previewImage(),changeColorPalette()}};getFromLocalStorage();const btnDelete=document.querySelector(".js-button--delete"),deleteData=function(){colorReset(),document.getElementById("color-option1").checked=!0,document.querySelector(".js-name").value="",document.querySelector(".js-job").value="",document.querySelector(".js-phone").value="",document.querySelector(".js-email").value="",document.querySelector(".js-linkedin").value="",document.querySelector(".js-github").value="",document.querySelector(".js__profile-upload-btn").value="",cardImage.style.backgroundImage="url('./assets/images/placeholderImg.jpg')",profilePreviewImg.src="./assets/images/placeholderImg.jpg",submitEl.classList.remove("share__button--active"),shareEle.classList.add("share__result--hidden"),picture="",localStorage.removeItem("userData")};function colorReset(){card.classList.remove("js-card-palette2"),card.classList.remove("js-card-palette3"),card.classList.remove("js-card-palette4"),card.classList.add("js-card-palette1")}const handleReset=function(){colorReset(),document.getElementById("color-option1").checked=!0,document.querySelector(".js-name").value="",document.querySelector(".js-job").value="",document.querySelector(".js-phone").value="",document.querySelector(".js-email").value="",document.querySelector(".js-linkedin").value="",document.querySelector(".js-github").value="",document.querySelector(".js__profile-upload-btn").value="",cardImage.style.backgroundImage="url('./assets/images/placeholderImg.jpg')",profilePreviewImg.src="./assets/images/placeholderImg.jpg",submitEl.classList.remove("share__button--active"),shareEle.classList.add("share__result--hidden"),picture="",localStorage.removeItem("userData"),changeCard()};btnDelete.addEventListener("click",handleReset);let submitButton=document.querySelector(".js-button"),responseURL=document.querySelector(".share__result__url"),twitterURL=document.querySelector(".share__result__button");function sendData(e){e.preventDefault();let t=getJSONFromInputs(Array.from(containerForm.elements));t.photo=picture,t.palette=document.querySelector('input[name="color-options"]:checked').value,sendRequest(t)}function getJSONFromInputs(e){return e.reduce(function(e,t){return"BUTTON"!==t.nodeName&&(e[t.name]=t.value),e},{})}function sendRequest(e){fetch("https://us-central1-awesome-cards-cf6f0.cloudfunctions.net/card/",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){showURL(e)}).catch(function(e){console.log(e)})}function showURL(e){if(e.success){responseURL.href=e.cardURL,responseURL.innerHTML=e.cardURL;let t="This is my awesome contact card!!";twitterURL.href=`https://twitter.com/intent/tweet?text=${t} ${e.cardURL}`,shareEle.classList.remove("share__result--hidden")}else responseURL.innerHTML="ERROR:"+e.error}submitButton.addEventListener("click",sendData);